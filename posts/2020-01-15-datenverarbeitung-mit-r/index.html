<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

  <!--radix_placeholder_meta_tags-->
<title>kuusisto.de: Datenverarbeitung mit R</title>

<meta property="description" itemprop="description" content="Ein Beispiel mit Studienrendenzahlen in gesundheitswissenschaftlichen Studiengängen 1998-2018."/>

<link rel="canonical" href="https://blog.kuusisto.de/posts/2020-01-15-datenverarbeitung-mit-r/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2020-01-15"/>
<meta property="article:created" itemprop="dateCreated" content="2020-01-15"/>
<meta name="article:author" content="Eero Kuusisto-Gussmann"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="kuusisto.de: Datenverarbeitung mit R"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Ein Beispiel mit Studienrendenzahlen in gesundheitswissenschaftlichen Studiengängen 1998-2018."/>
<meta property="og:url" content="https://blog.kuusisto.de/posts/2020-01-15-datenverarbeitung-mit-r/"/>
<meta property="og:image" content="https://blog.kuusisto.de/posts/2020-01-15-datenverarbeitung-mit-r/grafik/stud_gesundheit_a4.png"/>
<meta property="og:image:width" content="3507"/>
<meta property="og:image:height" content="2480"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="kuusisto.de"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="kuusisto.de: Datenverarbeitung mit R"/>
<meta property="twitter:description" content="Ein Beispiel mit Studienrendenzahlen in gesundheitswissenschaftlichen Studiengängen 1998-2018."/>
<meta property="twitter:url" content="https://blog.kuusisto.de/posts/2020-01-15-datenverarbeitung-mit-r/"/>
<meta property="twitter:image" content="https://blog.kuusisto.de/posts/2020-01-15-datenverarbeitung-mit-r/grafik/stud_gesundheit_a4.png"/>
<meta property="twitter:image:width" content="3507"/>
<meta property="twitter:image:height" content="2480"/>
<meta property="twitter:site" content="@eerok"/>

<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Tidy data;citation_publication_date=2014;citation_publisher=Foundation for Open Access Statistics;citation_volume=59;citation_author=Hadley Wickham;citation_author=Tidy data"/>
  <meta name="citation_reference" content="citation_title=Welcome to the Tidyverse;citation_publication_date=2019;citation_volume=4;citation_doi=10.21105/joss.01686;citation_author=Hadley Wickham;citation_author=Mara Averick;citation_author=Jennifer Bryan;citation_author=Winston Chang;citation_author=Lucy D’Agostino McGowan;citation_author=Romain François;citation_author=Garrett Grolemund;citation_author=Alex Hayes;citation_author=Lionel Henry;citation_author=Jim Hester;citation_author=Max Kuhn;citation_author=Thomas Lin Pedersen;citation_author=Evan Miller;citation_author=Stephan Milton Bache;citation_author=Kirill Müller;citation_author=Jeroen Ooms;citation_author=David Robinson;citation_author=Dana Paige Seidel;citation_author=Vitalie Spinu;citation_author=Kohske Takahashi;citation_author=Davis Vaughan;citation_author=Claus Wilke;citation_author=Kara Woo;citation_author=Hiroaki Yutani"/>
  <meta name="citation_reference" content="citation_title=ggplot2: Elegant Graphics for Data Analysis;citation_publication_date=2016;citation_publisher=Springer;citation_author=Hadley Wickham"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","bibliography","preview","categories","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Datenverarbeitung mit R"]},{"type":"character","attributes":{},"value":["Ein Beispiel mit Studienrendenzahlen in gesundheitswissenschaftlichen Studiengängen 1998-2018."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Eero Kuusisto-Gussmann"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]},{"type":"character","attributes":{},"value":["01-15-2020"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["refs.bib"]},{"type":"character","attributes":{},"value":["grafik/stud_gesundheit_a4.png"]},{"type":"character","attributes":{},"value":["R","Datenvisualisierung","Datenverarbeitung","German"]},{"type":"character","attributes":{},"value":["https://blog.kuusisto.de/posts/2020-01-15-datenverarbeitung-mit-r/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["datenverarbeitung-mit-r_files/bowser-1.9.3/bowser.min.js","datenverarbeitung-mit-r_files/distill-2.2.21/template.v2.js","datenverarbeitung-mit-r_files/figure-html5/unnamed-chunk-7-1.png","datenverarbeitung-mit-r_files/jquery-1.11.3/jquery.min.js","datenverarbeitung-mit-r_files/webcomponents-2.0.0/webcomponents.js","grafik/excel_screenshot.png","grafik/stud_gesundheit_a4.pdf","grafik/stud_gesundheit_a4.png","refs.bib"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #455a64;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative;}
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

</style>

<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for table of contents */

.d-toc {
  color: rgba(0,0,0,0.8);
  font-size: 0.8em;
  line-height: 1em;
}

.d-toc-header {
  font-size: 0.6rem;
  font-weight: 400;
  color: rgba(0, 0, 0, 0.5);
  text-transform: uppercase;
  margin-top: 0;
  margin-bottom: 1.3em;
}

.d-toc a {
  border-bottom: none;
}

.d-toc ul {
  padding-left: 0;
}

.d-toc li>ul {
  padding-top: 0.8em;
  padding-left: 16px;
  margin-bottom: 0.6em;
}

.d-toc ul,
.d-toc li {
  list-style-type: none;
}

.d-toc li {
  margin-bottom: 0.9em;
}

.d-toc-separator {
  margin-top: 20px;
  margin-bottom: 2em;
}

.d-article-with-toc {
  border-top: none;
  padding-top: 0;
}



/* Tweak code blocks (note that this CSS is repeated above in an injection
   into the d-code shadow dom) */

d-code {
  overflow-x: auto !important;
}

pre.d-code code.d-code {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

pre.text-output {

  font-size: 12px;
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

@media(min-width: 768px) {

d-code {
  overflow-x: visible !important;
}

pre.d-code code.d-code  {
    padding-left: 18px;
    font-size: 14px;
}
pre.text-output {
  font-size: 14px;
}
}

/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}



/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}


/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // create d-bibliography
  var bibliography = $('<d-bibliography></d-bibliography>');
  $('#distill-bibliography').wrap(bibliography);

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace citations with <d-cite>
  $('.citation').each(function(i, val) {
    appendix = true;
    var cites = $(this).attr('data-cites').split(" ");
    var dt_cite = $('<d-cite></d-cite>');
    dt_cite.attr('key', cites.join());
    $(this).replaceWith(dt_cite);
  });
  // remove refs
  $('#refs').remove();

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-toc a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // replace code blocks with d-code
  $('pre>code').each(function(i, val) {
    var code = $(this);
    var pre = code.parent();
    var clz = "";
    var language = pre.attr('class');
    if (language) {
      // map unknown languages to "clike" (without this they just dissapear)
      if ($.inArray(language, ["bash", "clike", "css", "go", "html",
                               "javascript", "js", "julia", "lua", "markdown",
                               "markup", "mathml", "python", "svg", "xml"]) == -1)
        language = "clike";
      language = ' language="' + language + '"';
      var dt_code = $('<d-code block' + language + clz + '></d-code>');
      dt_code.text(code.text());
      pre.replaceWith(dt_code);
    } else {
      code.addClass('text-output').unwrap().changeElementType('pre');
    }
  });

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('d-code, pre.text-output, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // table of contents
    if (have_authors) // adjust border if we are in authors
      $('.d-toc').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // inject pre code styles (can't do this with a global stylesheet b/c a shadow root is used)
    $('d-code').each(function(i, val) {
      var style = document.createElement('style');
      style.innerHTML = 'pre code { padding-left: 10px; font-size: 12px; border-left: 2px solid rgba(0,0,0,0.1); } ' +
                        '@media(min-width: 768px) { pre code { padding-left: 18px; font-size: 14px; } }';
      if (this.shadowRoot)
        this.shadowRoot.appendChild(style);
    });

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-toc-header').remove();
  $('.d-toc').remove();
  $('.d-toc-separator').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-148515502-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-148515502-1');
</script>
<style type="text/css">
*{font-family: 'Fira Sans', sans-serif;}
.bold{font-weight:bold;}
.italic{font-style: italic;}
.oblique{font-style: oblique;}

code,
.code,
pre {
  font-family: "Lucida Sans Typewriter", "Lucida Console", monaco, "Bitstream Vera Sans Mono", monospace; 
  background: #fff6f2;
  font-size: 15px;
  padding: 0;
  padding: 2px;
  border-radius: 4px;
  }

.distill-site-nav {
  color: #E95420;
  background-color: #f7f7f7;
  font-size: 15px;
  font-weight: bold;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: gray;
}

.distill-site-header {
}

.distill-site-footer {
  font-size: 12px;
  font-weight: 300;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}
.icon-link {
  border: none;
}
</style>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Datenverarbeitung mit R","description":"Ein Beispiel mit Studienrendenzahlen in gesundheitswissenschaftlichen Studiengängen 1998-2018.","authors":[{"author":"Eero Kuusisto-Gussmann","authorURL":{},"affiliation":"&nbsp;","affiliationURL":"#"}],"publishedDate":"2020-01-15T00:00:00.000+01:00","citationText":"Kuusisto-Gussmann, 2020"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">kuusisto.de</a>
</div>
<div class="nav-right">
<a href="../../index.html">Posts</a>
<a href="../../about.html">Über mich</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Datenverarbeitung mit R</h1>
<p>Ein Beispiel mit Studienrendenzahlen in gesundheitswissenschaftlichen Studiengängen 1998-2018.</p>
</div>

<div class="d-byline">
  Eero Kuusisto-Gussmann true 
  
<br/>01-15-2020
</div>

<div class="d-article">
<h1 id="einleitung">Einleitung</h1>
<p>Ich werde hin und wieder gefragt, warum ich mir die Zeit genommen habe, <a href="https://cran.r-project.org">R</a> zu lernen. Vieles was R kann, kann natürlich auch Excel oder SPSS. Weit verbreitet scheint auch das Missverständnis zu sein, dass das Nutzen von R auf reine Statistik beschränkt ist. Ein viel wichtigerer Grund für mich ist die Erstellung von R-Skripten, welche ich immer wieder bei ähnlichen Aufgaben verwenden kann, sowie die umfassenden Möglichkeiten bei der Datenverarbeitung. Häufig kommen Daten nämlich in einer Form, die erst umgewandelt oder neu strukturiert werden muss, bevor eine Analyse überhaupt möglich ist. Im Folgenden zeige ich Schritt für Schritt einen beispielhaften Workflow, um Daten vom Statischen Bundesamt in ein visualisierbares Format zu bringen.</p>
<h1 id="aufgabe">Aufgabe</h1>
<p>Vor einigen Tagen wollte ich wissen, wie sich die Zahl der Studierenden in gesundheitswissenschaftlichen Studiengängen über die Jahre hinweg in den Bundesländern entwickelt hat. Die Daten sind zwar vom <a href="https://www-genesis.destatis.de/genesis//online/data?operation=table&amp;code=21311-0003&amp;levelindex=1&amp;levelid=1579077939884">Statistischen Bundesamt</a> frei verfügbar, aber leider konnte ich keine gute Visualisierung finden, die für meinen Zweck brauchbar gewesen wäre.</p>
<h1 id="importieren">Importieren</h1>
<p><a href="https://www-genesis.destatis.de/genesis/online/data?operation=abruftabelleBearbeiten&amp;levelindex=2&amp;levelid=1579089950164&amp;auswahloperation=abruftabelleAuspraegungAuswaehlen&amp;auswahlverzeichnis=ordnungsstruktur&amp;auswahlziel=werteabruf&amp;code=21311-0006&amp;auswahltext=&amp;werteabruf=Werteabruf">Die Daten</a> kommen in einem Format, das zwar für Menschen gut lesbar, aber für eine nähere Analyse wirklich nicht geeignet ist (Abbildung <a href="#fig:screenshot">1</a>). Versuche z.B. nur gewisse Jahre oder Bundesländer zu filtern. Es ist zwar machbar, aber schwierig, da nicht jede Zeile diese Informationen beinhaltet.</p>
<p>Die Daten sind sozusagen nicht <em>tidy</em> bzw. nicht in Form einer Matrix, in der jeweils eine Zeile für eine Beobachtung und eine Spalte für eine Variable steht <span class="citation" data-cites="wickham2014tidy">(Wickham and others <a href="#ref-wickham2014tidy">2014</a>)</span>. Um die Daten überhaupt visualisieren zu können, müssen sie in ein besseres Format gebracht werden. In Excel könnte man z.B. ein neues Tabellenblatt nutzen und mit Hilfe von Funktionen die relevanten Daten aus dem anderen Blatt einlesen. Das Problem dabei ist, dass es ganz schön viel <em>copy-paste</em> erfordern würde und die Formeln per Hand in die richtigen Zellen eingegeben werden müssten.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:screenshot"></span>
<img src="grafik/excel_screenshot.png" alt="Screenshot der Excel-Datei" width="847" />
<p class="caption">
Figure 1: Screenshot der Excel-Datei
</p>
</div>
</div>
<p>Die Abbildung <a href="#fig:screenshot">1</a> zeigt das Hauptproblem: die Zeilen an sich sind weder zu einem Bundesland noch zum Semester eindeutig zuordenbar, da diese nur als Überschriften vorhanden sind. Darüber hinaus bestehen die Namen der Spalten aus mehreren Zellen. Versuchen wir diese in R einfach so einzulesen, sieht das Ergebnis nicht so vielversprechend aus:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(readxl)
erster_versuch &lt;- read_excel(&quot;_data/studienrende_gesundheit.xlsx&quot;)

erster_versuch</code></pre>
<pre><code>
# A tibble: 1,708 x 11
   `Studierende: B… ...2  ...3  ...4  ...5  ...6  ...7  ...8  ...9 
   &lt;chr&gt;            &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 &quot;Statistik der … &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 2 &quot;Studierende (A… &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 3 &quot;Semester\nBund… &lt;NA&gt;  Deut… &lt;NA&gt;  &lt;NA&gt;  Ausl… &lt;NA&gt;  &lt;NA&gt;  Insg…
 4  &lt;NA&gt;            &lt;NA&gt;  männ… weib… Insg… männ… weib… Insg… männ…
 5 &quot;WS 1998/99&quot;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 6 &quot;Baden-Württemb… &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 7 &quot;SF195&quot;          Gesu… -     -     -     -     -     -     -    
 8 &quot;SF232&quot;          Gesu… -     -     -     -     -     -     -    
 9 &quot;SF233&quot;          Nich… -     -     -     -     -     -     -    
10 &quot;SF234&quot;          Pfle… -     -     -     -     -     -     -    
# … with 1,698 more rows, and 2 more variables: ...10 &lt;chr&gt;,
#   ...11 &lt;chr&gt;</code></pre>
</div>
<p>Die Zeile mit den Spaltennamen ist nicht wirklich informativ. Da es in diesem Fall um nur wenige Spalten sind, können sie am Einfachsten manuell benannt werden. Auch die nächsten Zeilen beinhalten nur Metadaten, die ignoriert werden können. Darüber hinaus sind die nächsten Schritte einfacher, wenn die leeren Zeilen sowie die Zeilen mit einem Strich (-) einheitlich als fehlende Daten bezeichnet bzw. mit <code>NA</code> ersetzt werden. Mit <code>read_excel()</code> ist das einfach und kann gleich beim Importieren erledigt werden:</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
zweiter_versuch &lt;- read_excel(&quot;_data/studienrende_gesundheit.xlsx&quot;,
                  # SDie palten benennen
                  col_names = c(&quot;SemBund&quot;, &quot;Studiengang&quot;,
                               &quot;Dt_m&quot;, &quot;Dt_f&quot;,
                               &quot;DtGesamt&quot;, &quot;Aus_m&quot;,
                               &quot;Aus_f&quot;, &quot;AusGesamt&quot;,
                               &quot;m&quot;,&quot;f&quot;, &quot;Gesamt&quot;),
                  # Die ersten fünf Zeilen überspringen
                  skip = 5,
                  # Fehlende Daten vereinheitlichen
                  na = c(&quot;-&quot;, &quot;&quot;))

zweiter_versuch</code></pre>
<pre><code>
# A tibble: 1,704 x 11
   SemBund Studiengang  Dt_m  Dt_f DtGesamt Aus_m Aus_f AusGesamt
   &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1 WS 199… &lt;NA&gt;           NA    NA       NA    NA    NA        NA
 2 Baden-… &lt;NA&gt;           NA    NA       NA    NA    NA        NA
 3 SF195   Gesundheit…    NA    NA       NA    NA    NA        NA
 4 SF232   Gesundheit…    NA    NA       NA    NA    NA        NA
 5 SF233   Nichtärztl…    NA    NA       NA    NA    NA        NA
 6 SF234   Pflegewiss…    NA    NA       NA    NA    NA        NA
 7 Bayern  &lt;NA&gt;           NA    NA       NA    NA    NA        NA
 8 SF195   Gesundheit…    NA    NA       NA    NA    NA        NA
 9 SF232   Gesundheit…    NA    NA       NA    NA    NA        NA
10 SF233   Nichtärztl…    NA    NA       NA    NA    NA        NA
# … with 1,694 more rows, and 3 more variables: m &lt;dbl&gt;, f &lt;dbl&gt;,
#   Gesamt &lt;dbl&gt;</code></pre>
</div>
<h1 id="verarbeiten">Verarbeiten</h1>
<p>Jetzt haben die Spalten zwar etwas kryptische Namen, aber sie folgen einer einheitlichen Logik und beschreiben den Inhalt der Spalten. Die nächste Herausforderung ist die Spalte <code>SemBund</code>. Sie birgt nämlich drei Verschiedene Informationen: das Semester, das Bundesland und einen Code des Studienfaches. Da die Kodierungen keine zusätzlichen Informationen enthalten, können diese eigentlich auch entfernt werden. Das Wichtigste ist als Nächstes die Zeilen eindeutig zu einem Semester und Bundesland zuzuordnen. Ich persönlich nutze dafür am Liebsten die Werkzeuge aus dem <a href="https://www.tidyverse.org"><code>tidyverse</code>-Metapaketen</a> <span class="citation" data-cites="tidyverse">(Wickham et al. <a href="#ref-tidyverse">2019</a>)</span> und lade diese daher auf. Damit muss ich die einzelnen Paketen (u.a. <code>dplyr</code>, <code>stringr</code> und <code>ggplot2</code>) nicht separat laden, wenn ich sie später brauche.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(tidyverse)

plot_data &lt;- zweiter_versuch %&gt;% 
  # wenn SemBund mit &#39;WS&#39; beginnt -&gt; Inhalt in Semester kopieren
  mutate(Semester = if_else(str_detect(SemBund, &quot;^WS&quot;), SemBund, NULL),
  # wenn SemBund NICHT mit &#39;WS&#39; oder &#39;SF&#39; beginnt -&gt; Inhalt in Bundesland kopieren
         Bundesland = if_else(!str_detect(SemBund, &quot;^WS|^SF&quot;), SemBund, NULL)) %&gt;% 
  # die neuen Spalten als erstes anzeigen
  select(Semester, Bundesland, everything())

plot_data</code></pre>
<pre><code>
# A tibble: 1,704 x 13
   Semester Bundesland SemBund Studiengang  Dt_m  Dt_f DtGesamt Aus_m
   &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1 WS 1998… &lt;NA&gt;       WS 199… &lt;NA&gt;           NA    NA       NA    NA
 2 &lt;NA&gt;     Baden-Wür… Baden-… &lt;NA&gt;           NA    NA       NA    NA
 3 &lt;NA&gt;     &lt;NA&gt;       SF195   Gesundheit…    NA    NA       NA    NA
 4 &lt;NA&gt;     &lt;NA&gt;       SF232   Gesundheit…    NA    NA       NA    NA
 5 &lt;NA&gt;     &lt;NA&gt;       SF233   Nichtärztl…    NA    NA       NA    NA
 6 &lt;NA&gt;     &lt;NA&gt;       SF234   Pflegewiss…    NA    NA       NA    NA
 7 &lt;NA&gt;     Bayern     Bayern  &lt;NA&gt;           NA    NA       NA    NA
 8 &lt;NA&gt;     &lt;NA&gt;       SF195   Gesundheit…    NA    NA       NA    NA
 9 &lt;NA&gt;     &lt;NA&gt;       SF232   Gesundheit…    NA    NA       NA    NA
10 &lt;NA&gt;     &lt;NA&gt;       SF233   Nichtärztl…    NA    NA       NA    NA
# … with 1,694 more rows, and 5 more variables: Aus_f &lt;dbl&gt;,
#   AusGesamt &lt;dbl&gt;, m &lt;dbl&gt;, f &lt;dbl&gt;, Gesamt &lt;dbl&gt;</code></pre>
</div>
<p>Nun hat jede Variable ihren eigenen Platz gefunden. Die Spalte <code>SemBund</code> ist damit überflüssig geworden und kann aus den Daten gestrichen werden. Es ist für die weitere Bearbeitung auch einfacher, wenn das <code>Semester</code> auf das Jahr reduziert wird. Darüber hinaus sollen die <code>Semester</code> und <code>Bundesland</code>-Spalten von oben nach unten “befüllt” werden, damit diese Informationen in jeder Zeile vorhanden sind. Da mich eigentlich nur die <em>Gesamtzahl</em> der Studierenden interessiert, können auch die Spalten mit Nationalität entfernt werden.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
plot_data &lt;- plot_data %&gt;% 
  # Semester an nicht alphanumerischen Zeichen in drei neue Spalten teilen
  separate(Semester, c(&quot;Prefix&quot;, &quot;Jahr&quot;, &quot;Jahr2&quot;)) %&gt;% 
  # Nur die relevanten Spalten auswählen
  select(Bundesland, Jahr, Studiengang, m, f, Gesamt) %&gt;%
  # Leere Zellen nach unten &#39;befüllen&#39;
  fill(Jahr, Bundesland)

plot_data</code></pre>
<pre><code>
# A tibble: 1,704 x 6
   Bundesland      Jahr  Studiengang                    m     f Gesamt
   &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;                      &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 &lt;NA&gt;            1998  &lt;NA&gt;                          NA    NA     NA
 2 Baden-Württemb… 1998  &lt;NA&gt;                          NA    NA     NA
 3 Baden-Württemb… 1998  Gesundheitspädagogik          NA    NA     NA
 4 Baden-Württemb… 1998  Gesundheitswissenschaften…    NA    NA     NA
 5 Baden-Württemb… 1998  Nichtärztliche Heilberufe…    NA    NA     NA
 6 Baden-Württemb… 1998  Pflegewissenschaft/-manag…    NA    NA     NA
 7 Bayern          1998  &lt;NA&gt;                          NA    NA     NA
 8 Bayern          1998  Gesundheitspädagogik          NA    NA     NA
 9 Bayern          1998  Gesundheitswissenschaften…    NA    NA     NA
10 Bayern          1998  Nichtärztliche Heilberufe…    NA    NA     NA
# … with 1,694 more rows</code></pre>
</div>
<p>Letztlich können auch noch die ehemaligen Überschriftszeilen gelöscht werden. Das ist einfach, da diese Zeilen eine Gemeinsamkeit haben: die Studiengangspalte ist auch leer. Danach können auch die leeren <code>NA</code>-Zeilen mit einer Null ersetzt werden, damit die Visualisierung einfacher wird.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
plot_data &lt;- plot_data %&gt;% 
  # Nur Zeilen auswählem, die KEINE leere Studiengang-Spalte haben
  filter(!is.na(Studiengang)) %&gt;% 
  # NA im gesamten Daten mit 0 ersetzen
  replace(is.na(.), 0)

plot_data</code></pre>
<pre><code>
# A tibble: 1,344 x 6
   Bundesland      Jahr  Studiengang                    m     f Gesamt
   &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;                      &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 Baden-Württemb… 1998  Gesundheitspädagogik           0     0      0
 2 Baden-Württemb… 1998  Gesundheitswissenschaften…     0     0      0
 3 Baden-Württemb… 1998  Nichtärztliche Heilberufe…     0     0      0
 4 Baden-Württemb… 1998  Pflegewissenschaft/-manag…     0     0      0
 5 Bayern          1998  Gesundheitspädagogik           0     0      0
 6 Bayern          1998  Gesundheitswissenschaften…     0     0      0
 7 Bayern          1998  Nichtärztliche Heilberufe…     0     0      0
 8 Bayern          1998  Pflegewissenschaft/-manag…     0     0      0
 9 Berlin          1998  Gesundheitspädagogik          61   186    247
10 Berlin          1998  Gesundheitswissenschaften…     0     0      0
# … with 1,334 more rows</code></pre>
</div>
<p>Sehr schön! Die Daten sind endlich in einem <em>tidy</em> Format und können weiter analysiert und visualisiert werden. Es ist jetzt zum Beispiel einfach zu schauen, wie viele Studierende des Faches <em>Pflegewissenschaft/-management</em> es in Bayern in den Jahren 2010-2015 gab.</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
plot_data %&gt;% 
  filter(Bundesland == &#39;Bayern&#39; &amp;
           Jahr &gt;= 2010 &amp; Jahr &lt;= 2015 &amp;
           Studiengang == &#39;Pflegewissenschaft/-management&#39;)</code></pre>
<pre><code>
# A tibble: 6 x 6
  Bundesland Jahr  Studiengang                        m     f Gesamt
  &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Bayern     2010  Pflegewissenschaft/-management   126   410    536
2 Bayern     2011  Pflegewissenschaft/-management   163   577    740
3 Bayern     2012  Pflegewissenschaft/-management   191   756    947
4 Bayern     2013  Pflegewissenschaft/-management   215   919   1134
5 Bayern     2014  Pflegewissenschaft/-management   223  1064   1287
6 Bayern     2015  Pflegewissenschaft/-management   272  1211   1483</code></pre>
</div>
<h1 id="visualisieren">Visualisieren</h1>
<p>Dann bleibt noch übrig die Daten mit <a href="https://ggplot2.tidyverse.org"><code>ggplot2</code></a> zu visualisieren. An dieser Stelle verzichte ich auf eine detaillierte Beschreibung des Vorgehens und Verweise auf das kostenlose Buch <em>ggplot2: Elegant Graphics for Data Analysis</em> <span class="citation" data-cites="wickham2016">(Wickham <a href="#ref-wickham2016">2016</a>)</span>, das einen sehr guten Einstieg für Datenvisualisierung mit <code>ggplot2</code> bietet!</p>
<div class="layout-chunk" data-layout="l-body">
<pre class="r"><code>
library(RColorBrewer)

bundesland_plot &lt;- plot_data %&gt;%
  ggplot(aes(Jahr, Gesamt, group = Studiengang, color = Studiengang)) +
  geom_line(size = 1, alpha = 0.7) +
  guides(color = guide_legend(reverse = TRUE)) +
  scale_color_brewer(palette = &quot;Dark2&quot;) +
  facet_wrap(vars(Bundesland), scales = &quot;free&quot;) +
  scale_x_discrete(breaks=c(2000, 2005, 2010, 2015, 2018)) +
  theme_minimal(base_family = &quot;Fira Sans&quot;) +
  theme(legend.position = &quot;top&quot;,
        legend.title = element_blank(),
        plot.caption = element_text(size = 6)) +
  labs(title = &quot;Entwicklung der Studierendenzahlen&quot;,
       subtitle = paste0(&quot;Studienbereich 48 - Gesundheitswissenschaften &quot;,
                         &quot;(&quot;, min(plot_data$Jahr), &quot;-&quot;, max(plot_data$Jahr), &quot;)&quot;),
       y = &quot;Studierende&quot;,
       caption = paste(&quot;Daten: Statistisches Bundesamt, Wiesbaden 2019&quot;,
       &quot;©Eero Kuusisto-Gussmann – CC-BY-4.0&quot;, sep = &quot;\n&quot;))

ggsave(&quot;grafik/stud_gesundheit_a4.pdf&quot;, bundesland_plot,
       width = 297, height = 210, units = &quot;mm&quot;, device = cairo_pdf)</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="figure" style="text-align: center"><span id="fig:png"></span>
<img src="grafik/stud_gesundheit_a4.png" alt="Das Endergebnis. [Herunterladen](grafik/stud_gesundheit_a4.pdf) &lt;font size=2&gt;(PDF, 1 Seite, 20.9 kB)&lt;/font&gt;" width="1754" />
<p class="caption">
Figure 2: Das Endergebnis. <a href="grafik/stud_gesundheit_a4.pdf">Herunterladen</a> <font size=2>(PDF, 1 Seite, 20.9 kB)</font>
</p>
</div>
</div>
<p>Leider deuten die Daten darauf hin, dass die Erhebung zwischen den Bundesländern nicht wirklich vergleichbar ist und Studiengänge höchstwahrscheinlich unterschiedlich klassifiziert werden. Zum Beispiel in Saarland gibt es einen <a href="https://www.htwsaar.de/sowi/Studium/b-sc-pflege">primärqualifizierenden Pflegestudiengang</a>, dieser scheint aber in der Statistik unter <em>Gesundheitswissenschaften/-management</em> zu fallen – oder gar nicht vorhanden zu sein. Ferner fällt auf, dass das Fach <em>Pflegewissenschaft/-management</em> erst ab 2004<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> in der Statistik auftaucht. Es wäre auch sinnvoller, die Zahlen als Anteil aller Studierenden in den Bundesländern darzustellen, da die Gesamtzahl der Studienrenden auch <a href="https://de.statista.com/statistik/daten/studie/221/umfrage/anzahl-der-studenten-an-deutschen-hochschulen/">einen klaren steigenden Trend aufweist</a>. Eine gute Übung war es aber trotzdem!</p>
<h1 id="fazit">Fazit</h1>
<p>Das obige Beispiel wäre zwar sicherlich auch mit Excel möglich, jedoch deutlich mühsamer und würde eine manuelle Bearbeitung der Datei erfordern. Der größte Vorteil von R ist hierbei wieder die <em>Reproduzierbarkeit</em>; es ist einfach den Prozess Schritt für Schritt nachzuvollziehen, kontrollieren und bei Bedarf wiederzuholen – auch mit neuen Daten. Wenn ich z.B. später auch die Daten aus 2019 einschließen möchte oder doch ein Fach übersehen hätte, müsste ich nur den neuen Datensatz von der Webseite herunterladen und den Namen der Datei in meinem R-Skript ändern. Danach könnte ich das Skript ausführen und hätte in wenigen Sekunden eine identische Darstellung mit den aktualisierten Daten.</p>
<div id="refs" class="references">
<div id="ref-wickham2016">
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer.</p>
</div>
<div id="ref-tidyverse">
<p>Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. “Welcome to the Tidyverse.” <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.</p>
</div>
<div id="ref-wickham2014tidy">
<p>Wickham, Hadley, and others. 2014. “Tidy Data.” <em>Journal of Statistical Software</em> 59 (10): 1–23.</p>
</div>
</div>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Vor 2004 waren die Studienrenden nach Informationen des Statischen Bundesamtes unter der etwas seltsamen Rubrik <em>Krankenpflege-Ausbildung</em> in der Studierendenstatistik zu finden.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Datenverarbeitung%20mit%20R&amp;url=https%3A%2F%2Fblog.kuusisto.de%2Fposts%2F2020-01-15-datenverarbeitung-mit-r%2F">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fblog.kuusisto.de%2Fposts%2F2020-01-15-datenverarbeitung-mit-r%2F&amp;title=Datenverarbeitung%20mit%20R">
        <i class="fab fa-linkedin"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fblog.kuusisto.de%2Fposts%2F2020-01-15-datenverarbeitung-mit-r%2F">
        <i class="fab fa-facebook"></i>
      </a>
    </span>
  </p>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<script id="distill-bibliography" type="text/bibtex">
@article{wickham2014tidy,
  title={Tidy data},
  author={Wickham, Hadley and others},
  journal={Journal of Statistical Software},
  volume={59},
  number={10},
  pages={1--23},
  year={2014},
  publisher={Foundation for Open Access Statistics}
}

@Article{tidyverse,
    title = {Welcome to the Tidyverse},
    author = {Hadley Wickham and Mara Averick and Jennifer Bryan and Winston Chang and Lucy D'Agostino McGowan and Romain François and Garrett Grolemund and Alex Hayes and Lionel Henry and Jim Hester and Max Kuhn and Thomas Lin Pedersen and Evan Miller and Stephan Milton Bache and Kirill Müller and Jeroen Ooms and David Robinson and Dana Paige Seidel and Vitalie Spinu and Kohske Takahashi and Davis Vaughan and Claus Wilke and Kara Woo and Hiroaki Yutani},
    year = {2019},
    journal = {Journal of Open Source Software},
    volume = {4},
    number = {43},
    pages = {1686},
    doi = {10.21105/joss.01686},
}

@book{wickham2016,
  title={ggplot2: Elegant Graphics for Data Analysis},
  author={Wickham, Hadley},
  year={2016},
  publisher={Springer}
}
</script>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
  <p>
    <a href="https://twitter.com/eerok" class="icon-link">
      <span class="fa fa-twitter"/>
    </a>
    <a href="https://www.xing.com/profile/Eero_KuusistoGussmann/" class="icon-link">
      <span class="fa fa-xing"/>
    </a>
    <a href="https://www.linkedin.com/in/eero-kuusisto-gussmann/" class="icon-link">
      <span class="fa fa-linkedin"/>
    </a>
    <a href="https://github.com/ek-g/" class="icon-link">
      <span class="fa fa-github"/>
    </a>
  </p>
  <p>© Copyright 2019-2020 – Eero Kuusisto-Gussmann – <a href="https://creativecommons.org/licenses/by/4.0/deed.de">CC-BY-4.0</a></p>
  <p>Powered by <a href="https://rstudio.github.io/distill/">Distill for R Markdown</a> &amp; <a href="https://pages.github.com">GitHub Pages</a></p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
